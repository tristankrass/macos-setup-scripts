- hosts: localhost
  connection: local
  tasks:
    - debug:
        msg: Check we are running in the directory of the script
      failed_when: not ansible_env.PWD.endswith('/macos-setup-scripts')

- hosts: localhost
  connection: local
  become: no

  tasks:

    - name: Setup Dock
      include_tasks: tasks/dock.yml

    - name: Apply additional macOS settings
      script: new_stuff.sh

  handlers:
    - name: kill dock
      command: killall Dock

    - name: kill finder
      command: killall Finder
